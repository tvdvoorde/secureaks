name: test

on:
  workflow_dispatch:

permissions:
  id-token: write
  contents: read

env:
  ARM_USE_OIDC=true
  ARM_SUBSCRIPTION_ID=${{ vars.SUBSCRIPTION_ID }}
  ARM_TENANT_ID=${{ vars.TENANT_ID }}
  ARM_CLIENT_ID=${{ vars.CLIENT_ID }}

jobs:
  run-blank:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: hashicorp/setup-terraform@v2
        with:
          terraform_version: 1.6.0
      - name: terraform init
        run: |
          terraform -chdir=infra init \
              -backend-config="key=secureaks.tfstate" \
              -backend-config="storage_account_name=sa101125"
      - name: terraform plan
        run: |
          terraform -chdir=infra plan 

              

